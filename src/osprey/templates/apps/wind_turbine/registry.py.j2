"""{{ app_display_name }} Application Registry Configuration.

This module defines the component registry for the {{ app_display_name }} application.
All wind turbine-specific capabilities, context classes, and data sources are declared here.

This registry demonstrates the intermediate pattern: using extend_framework_registry()
with exclusions. The framework's generic Python capability is replaced with a
specialized turbine analysis capability that provides domain-specific functionality.
"""

from osprey.registry import (
    extend_framework_registry,
    CapabilityRegistration, 
    ContextClassRegistration, 
    DataSourceRegistration,
    FrameworkPromptProviderRegistration,
    RegistryConfig,
    RegistryConfigProvider
)

class {{ app_class_name }}RegistryProvider(RegistryConfigProvider):
    """Registry provider for {{ app_display_name }} application.
    
    This registry demonstrates the intermediate pattern of extending the framework
    while excluding and replacing specific components. The framework provides core
    infrastructure (routing, memory, time parsing, etc.), and this application:
    
    1. Adds specialized wind turbine capabilities
    2. Excludes the generic Python capability
    3. Provides turbine_analysis as a specialized replacement
    4. Adds domain-specific data sources and prompt providers
    
    This pattern is perfect for applications that need most framework features
    but want to replace specific components with specialized implementations.
    """
    
    def get_registry_config(self) -> RegistryConfig:
        """Get {{ package_name }} application registry configuration.
        
        Uses extend_framework_registry() to automatically include framework
        components while adding turbine-specific capabilities and excluding
        the generic Python capability (replaced with specialized turbine_analysis).
        
        Returns:
            RegistryConfig: Complete registry with framework + turbine components
        """
        return extend_framework_registry(
            # Add wind turbine capabilities
            capabilities=[
            CapabilityRegistration(
                name="weather_data_retrieval",
                module_path="{{ package_name }}.capabilities.weather_data_retrieval",
                class_name="WeatherDataRetrievalCapability", 
                description="Retrieve weather data for wind analysis",
                provides=["WEATHER_DATA"],
                requires=["TIME_RANGE"]
            ),
            CapabilityRegistration(
                name="knowledge_retrieval",
                module_path="{{ package_name }}.capabilities.knowledge_retrieval",
                class_name="KnowledgeRetrievalCapability",
                description="Retrieve technical standards and performance benchmarks from knowledge base",
                provides=["TURBINE_KNOWLEDGE"],
                requires=[]
            ),
            CapabilityRegistration(
                name="turbine_data_archiver",
                module_path="{{ package_name }}.capabilities.turbine_data_archiver",
                class_name="TurbineDataArchiverCapability",
                description="Retrieve historical turbine performance data",
                provides=["TURBINE_DATA"],
                requires=["TIME_RANGE"]
            ),
            CapabilityRegistration(
                name="turbine_analysis",
                module_path="{{ package_name }}.capabilities.turbine_analysis",
                class_name="TurbineAnalysisCapability",
                description="Analyze turbine performance against industry benchmarks",
                provides=["ANALYSIS_RESULTS"],
                requires=["TURBINE_DATA", "WEATHER_DATA", "TURBINE_KNOWLEDGE"]
            )
            ],
            
            # Add wind turbine context classes
            context_classes=[
                ContextClassRegistration(
                    context_type="TURBINE_DATA",
                    module_path="{{ package_name }}.context_classes", 
                    class_name="TurbineDataContext"
                ),
                ContextClassRegistration(
                    context_type="WEATHER_DATA",
                    module_path="{{ package_name }}.context_classes",
                    class_name="WeatherDataContext"
                ),
                ContextClassRegistration(
                    context_type="ANALYSIS_RESULTS",
                    module_path="{{ package_name }}.context_classes",
                    class_name="AnalysisResultsContext"
                ),
                ContextClassRegistration(
                    context_type="TURBINE_KNOWLEDGE",
                    module_path="{{ package_name }}.context_classes",
                    class_name="TurbineKnowledgeContext"
                ),
            ],
            
            # Add wind turbine data sources
            data_sources=[
                DataSourceRegistration(
                    name="wind_farm_knowledge",
                    module_path="{{ package_name }}.data_sources.knowledge_provider",
                    class_name="WindFarmKnowledgeProvider",
                    description="Mock RAG-style knowledge base for wind farm domain expertise"
                )
            ],
            
            # Add wind turbine prompt providers
            framework_prompt_providers=[
                FrameworkPromptProviderRegistration(
                    application_name="{{ package_name }}",
                    module_path="{{ package_name }}.framework_prompts",
                    description="{{ app_display_name }}-specific framework prompt provider for enhanced analysis reporting",
                    prompt_builders={
                        "response_generation": "WindTurbineResponseGenerationPromptBuilder"
                    }
                )
            ],
            
            # Exclude framework Python capability (replaced with specialized turbine_analysis)
            # The turbine_analysis capability provides the same ANALYSIS_RESULTS context
            # but with domain-specific logic for wind turbine performance analysis
            exclude_capabilities=["python"],
        ) 
